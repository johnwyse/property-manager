{% extends "property/layout.html" %}

{% block body %}

    {% if user.tenant %}
        <h1>Hello, {{user.first_name}}!</h1>

        <div class="list-container">
        {% if my_unit %}

        <div class="listed-item">
            <p>{{my_unit}}</p>
            <p>Property Manager: {{my_unit.manager.first_name}} {{my_unit.manager.last_name}}</p>
            {% if my_unit.image %}
            <img src="{{ my_unit.image }}" alt="{{ unit.address }}" height=200>
            {% endif %}
        </div>

        <div class="inline-container">
            <div class="inline-child">
                <button onclick="show_report_issue_form_inline()" id="show_report_issue_form">Report an issue to {{my_unit.manager.first_name}}</button>
                
                <div class="report-issue-form">
                    <form action="{% url 'report_issue' %}" method="post">
                        {% csrf_token %}
                        <input class="issue_input" id="issue_title" name="title" autocomplete=off type=text placeholder="Title">
                        <br><br>
                        <input class="issue_input" id="issue_image" name="image" autocomplete=off type=text placeholder="Image URL (optional)">
                        <br><br>
                        <textarea class="issue_input" id="issue_description" name="description" autocomplete=off type=text placeholder="Description" rows=4 cols=80></textarea>
                        <br><br>
                        <input class="btn btn-warning" type="submit" value="Submit Issue">
                    </form>
                </div>
            </div>

            <div class="inline-child">
                <button onclick="show_send_message_form_inline()" id="show_send_message_form">Send {{my_unit.manager.first_name}} a message</button>
                
                <div id="send-message-form">
                    <form action="{% url 'send_message' %}" method="post">
                        {% csrf_token %}
                        <textarea class="message_input" id="message_text" name="text" autocomplete=off type=text placeholder="Message" rows=6 cols=100></textarea>
                        <br><br>
                        <input class="message_input" id="message_image" name="image" autocomplete=off type=text placeholder="Image URL (optional)">
                        <br><br>
                        <input class="btn btn-warning" type="submit" value="Send Message">
                    </form>
                </div>
            </div>
        </div>
        

        {% else %}

        <p>TODO: Find your unit in this form!</p>

        {% endif %}
        </div>


    {% endif %}

    {% if user.manager %}
        
        {% if not units %}

            <br><br>
            <p> You have not registered any properties yet. </p>
            <p> Let's get started! </p>
            <br><br>

            <div class="add-property-link">
                <a href="{% url 'add_property' %}">Add Property</a>
            </div>
        
        {% else %}

            <h1>My Properties:</h1>

            <div class="add-property-link">
                <a href="{% url 'add_property' %}">Add Property</a>
            </div>

            <div class="list-container">
            {% for unit in units %}

                <div class="listed-item-link">
                    <a href="{% url 'unit' unit.id %}">{{unit}}</a>
                </div>
                
            {% endfor %}
            </div>

        {% endif %}



    {% endif %}

{% endblock %}